<!DOCTYPE html>
<html>
<head>
<title>Restaurant Table Booking</title>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

<style>
body {
    margin:0;
    font-family: Arial;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    overflow:hidden;
    animation: fadeIn 1.5s ease-in-out;
}

@keyframes fadeIn {
    from {opacity:0;}
    to {opacity:1;}
}

.bg-video{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    object-fit:cover;
    z-index:-2;
}

.overlay{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:rgba(0,0,0,0.4);
    z-index:-1;
}

.card {
    padding:50px;
    border-radius:20px;
    box-shadow:0 10px 70px rgba(0,0,0,0.3);
    width:350px;
    background: #111;
    color: white;
    animation: slideUp 1s ease-out;
}

@keyframes slideUp {
    from {opacity:0; transform:translateY(40px);}
    to {opacity:1; transform:translateY(0);}
}

input, button {
    width:100%;
    padding:10px;
    margin:10px 0;
    box-sizing: border-box;
}

button {
    background:#064e3b;
    color:white;
    border:none;
    cursor:pointer;
    font-weight: bold;
}

.success{
    display:none;
}

.about-btn{
    position:absolute;
    top:25px;
    right:30px;
    padding:10px 22px;
    background:#FFD700;
    color:black;
    text-decoration:none;
    font-weight:bold;
    border-radius:30px;
    box-shadow:0 5px 15px rgba(0,0,0,0.3);
    transition:0.3s ease;
}

.about-btn:hover{
    background:white;
    transform:scale(1.1);
}
</style>
</head>

<body>
<a href="about.html" class="about-btn">About Us</a>
<video autoplay muted loop class="bg-video">
    <source src="video.mp4" type="video/mp4">
</video>

<div class="overlay"></div>

<div class="card" id="bookingForm">
<h2 style="text-align:center;color:yellow;">Book Your Table</h2>

<input type="text" id="name" placeholder="Full Name" required>

<input type="tel" id="mobile" placeholder="Mobile Number"
maxlength="10" pattern="[0-9]{10}" required>

<input type="date" id="date" required>

<input type="time" id="time" required>

<input type="number" id="guests" placeholder="Number of Guests"
min="1" max="20" required>

<button onclick="book()">Book Now</button>

<p id="msg" style="color:red;text-align:center;"></p>
</div>


<div class="card success" id="successPage">
<h2 style="color:green;text-align:center;">âœ… Booking Confirmed!</h2>

<p><strong>Name:</strong> <span id="sname"></span></p>
<p><strong>Mobile:</strong> <span id="smobile"></span></p>
<p><strong>Date:</strong> <span id="sdate"></span></p>
<p><strong>Time:</strong> <span id="stime"></span></p>
<p><strong>Guests:</strong> <span id="sguests"></span></p>

<button onclick="goBack()">Back</button>
</div>

<script>
// Initialize Firebase
const firebaseConfig = {
    apiKey: "AIzaSyAzg6lEGVS-hcedC7ZhWdz0uq1_vtqTCCA",
    authDomain: "arabian-nights-cca24.firebaseapp.com",
    databaseURL: "https://arabian-nights-cca24-default-rtdb.firebaseio.com",
    projectId: "arabian-nights-cca24",
    storageBucket: "arabian-nights-cca24.firebasestorage.app",
    messagingSenderId: "405951495752",
    appId: "1:405951495752:web:cedcf446717f9359b2e27d",
    measurementId: "G-N6ZC0F2J5V"
};
firebase.initializeApp(firebaseConfig);
const database = firebase.database();

// Prevent previous dates
let today = new Date().toISOString().split("T")[0];
document.getElementById("date").setAttribute("min", today);

function book(){
    let name = document.getElementById("name").value;
    let mobile = document.getElementById("mobile").value;
    let date = document.getElementById("date").value;
    let time = document.getElementById("time").value;
    let guests = document.getElementById("guests").value;

    if(mobile.length != 10){
        document.getElementById("msg").innerText = "Phone number must be 10 digits!";
        return;
    }

    if(guests > 20){
        document.getElementById("msg").innerText = "Maximum 20 guests allowed!";
        return;
    }

    // Save to Firebase instead of localStorage
    database.ref('bookings').push({
        name: name,
        mobile: mobile,
        date: date,
        time: time,
        guests: guests,
        timestamp: new Date().toISOString()
    }).then(() => {
        // Show success page
        document.getElementById("bookingForm").style.display="none";
        document.getElementById("successPage").style.display="block";

        // Display details
        document.getElementById("sname").innerText = name;
        document.getElementById("smobile").innerText = mobile;
        document.getElementById("sdate").innerText = date;
        document.getElementById("stime").innerText = time;
        document.getElementById("sguests").innerText = guests;
    }).catch(error => {
        document.getElementById("msg").innerText = "Booking failed. Try again.";
    });
}

function goBack(){
    document.getElementById("successPage").style.display="none";
    document.getElementById("bookingForm").style.display="block";
    
    // Clear fields
    document.getElementById("name").value = "";
    document.getElementById("mobile").value = "";
    document.getElementById("date").value = "";
    document.getElementById("time").value = "";
    document.getElementById("guests").value = "";
}
</script>

</body>
</html>